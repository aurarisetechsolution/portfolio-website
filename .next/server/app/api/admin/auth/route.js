"use strict";(()=>{var e={};e.id=266,e.ids=[266],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8254:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>A,patchFetch:()=>v,requestAsyncStorage:()=>w,routeModule:()=>x,serverHooks:()=>j,staticGenerationAsyncStorage:()=>k});var n={};r.r(n),r.d(n,{GET:()=>h,POST:()=>g});var a=r(3278),o=r(5002),s=r(4877),i=r(1309);let u=["127.0.0.1","::1","localhost"],p={admin:"aurarise2024@secure",manager:"aurarise2024@manager"},d=new Map;function l(e){let t=e.headers.get("x-forwarded-for"),r=e.headers.get("x-real-ip");return t?t.split(",")[0].trim():r||"127.0.0.1"}function c(e){return u.includes(e)}function m(e){let t=d.get(e);if(!t)return!1;let r=Date.now();return t.count>=5&&r-t.lastAttempt<9e5||(r-t.lastAttempt>=9e5&&d.delete(e),!1)}function f(e){let t=d.get(e)||{count:0,lastAttempt:0};t.count+=1,t.lastAttempt=Date.now(),d.set(e,t)}async function h(e){let t=l(e);return i.NextResponse.json({ip:t,allowed:c(t),blocked:m(t),timestamp:new Date().toISOString()})}async function g(e){try{let t=l(e),{username:r,password:n}=await e.json();if(!c(t))return i.NextResponse.json({error:"IP not authorized",ip:t},{status:403});if(m(t))return i.NextResponse.json({error:"IP temporarily blocked due to failed attempts"},{status:429});if(!r||!n)return f(t),i.NextResponse.json({error:"Username and password required"},{status:400});let a=p[r];if(!a||a!==n)return f(t),i.NextResponse.json({error:"Invalid credentials"},{status:401});d.delete(t);let o=Buffer.from(`${r}:${Date.now()}:${t}`).toString("base64");return i.NextResponse.json({success:!0,user:{username:r,role:"admin"===r?"Administrator":"Manager",lastLogin:new Date().toISOString(),ip:t},token:o,timestamp:new Date().toISOString()})}catch(e){return console.error("Authentication error:",e),i.NextResponse.json({error:"Authentication failed"},{status:500})}}let x=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/admin/auth/route",pathname:"/api/admin/auth",filename:"route",bundlePath:"app/api/admin/auth/route"},resolvedPagePath:"/home/alki/Project/kekeb-tech-website/app/api/admin/auth/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:w,staticGenerationAsyncStorage:k,serverHooks:j}=x,A="/api/admin/auth/route";function v(){return(0,s.patchFetch)({serverHooks:j,staticGenerationAsyncStorage:k})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[787,833],()=>r(8254));module.exports=n})();